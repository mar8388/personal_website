function toRad(a){return parseFloat(a)*Math.PI/180}function x1(a){return Math.sin(a*Math.PI/180)*Math.pow(Math.pow(m,2)-Math.pow(b,2),.5)}function y1(a){return Math.cos(a*Math.PI/180)*Math.pow(Math.pow(m,2)-Math.pow(b,2),.5)}function x2(a){return Math.cos(-1*a*Math.PI/180)*b}function y2(a){return b*Math.sin(-1*a*Math.PI/180)}function x3(a){return-1*Math.cos(-1*a*Math.PI/180)*b}function y3(a){return-1*b*Math.sin(-1*a*Math.PI/180)}function initialize(){function c(){$.ajax({type:"GET",url:"https://georgejose.com:3002/agencies/ttc/vehicles",success:function(a){itemsChanged=0;for(var b=a.length,c=0;c<b;c++){var d=a[c].id,e=new google.maps.LatLng(parseFloat(a[c].lat),parseFloat(a[c].lon)),f=a[c].secsSinceReport,g=a[c].heading;polygonOptions.title=a[c].routeId,polygonOptions.icon.rotation=parseFloat(g),opacity=(100-5/3*f)/100,d in vehicles?vehicles[d].xy.lat()!=e.lat()?(itemsChanged+=1,vehicles[d].xy=e,polygonOptions.position=e,polygonOptions.icon.fillOpacity=opacity,polygonOptions.icon.strokeOpacity=opacity,polygons[d].setOpacity(opacity),polygons[d].setIcon(polygonOptions.icon),polygons[d].setPosition(e)):polygons[d].setOpacity(opacity):(vehicles[d]={xy:e,age:f},polygonOptions.position=e,polygonOptions.icon.fillOpacity=opacity,polygonOptions.icon.strokeOpacity=opacity,polygons[d]=new SlidingMarker(polygonOptions))}}})}var a={zoom:15,center:new google.maps.LatLng(43.64467,-79.39959)},b=new google.maps.Map(document.getElementById("map-canvas"),a);options.map=b,polygonOptions.map=b,setInterval(c,3e3)}SlidingMarker.initializeGlobally(),m=100,b=10;var cityCircle,options={radius:10,strokeOpacity:1,strokeWeight:.5,fillOpacity:1,strokeColor:"#FFFFFF"},polygonOptions={icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,scale:1.5,fillColor:"#000080",strokeColor:"#000080",fillOpacity:1,strokeOpacity:1},duration:5e3,draggable:!1,title:"ABC"},infoWindow=new google.maps.InfoWindow,polygons={},vehicles={},ages=[],circles={},itemsChanged=0,opacity=0;google.maps.event.addDomListener(window,"load",initialize);